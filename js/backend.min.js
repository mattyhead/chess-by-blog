var RPBChessboard={};(function(e,t){"use strict";function et(e){if(typeof e===R)return e;if(typeof e!==O)return g;switch(e[K]()){case"true":case"yes":case"1":return w;case"false":case"no":case"0":return k;default:return g}}function tt(n,r,s){var u=t(p);if(typeof n===O){u[i](b,F,n),t(m+u[i](D))[x](a,w),t("#rpbchessboard-editFENDialog-castle-wk")[x](a,u[i](c,"w","k")),t("#rpbchessboard-editFENDialog-castle-wq")[x](a,u[i](c,"w","q")),t("#rpbchessboard-editFENDialog-castle-bk")[x](a,u[i](c,"b","k")),t("#rpbchessboard-editFENDialog-castle-bq")[x](a,u[i](c,"b","q"));var l=u[i](N);t("#rpbchessboard-editFENDialog-enPassant-"+(l===W?E:"enabled"))[x](a,w),t(o)[x](E,l===W),l!==W&&t(o).val(l)}typeof r===R&&t("#rpbchessboard-editFENDialog-submitButton").button(b,"label",r?e[y].SUBMIT_BUTTON_ADD_LABEL:e[y].SUBMIT_BUTTON_EDIT_LABEL);if(typeof s===z&&s!==g){var h=T in s?et(s[T]):g;h===g&&(h=k),u[i](b,T,h),t(f)[x](a,h)}}function nt(){if(t(u)[q]!==0)return;t("body").append('<div id="rpbchessboard-editFENDialog"><div class="rpbchessboard-columns"><div style="width: 450px;"><div id="rpbchessboard-editFENDialog-chessboard"></div>'+s+'<div class="rpbchessboard-stretchable">'+'<div class="rpbchessboard-jQuery-enableSmoothness">'+'<div id="rpbchessboard-editFENDialog-accordion" class="rpbchessboard-accordion">'+G+e[y].BASIC_TAB_LABEL+X+V+r+e[y].TURN_SECTION_TITLE+s+n+l+'<label for="rpbchessboard-editFENDialog-turn-w">'+'<span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-w uichess-chessboard-size36"></span>'+v+'<input id="rpbchessboard-editFENDialog-turn-w" type="radio" name="turn" value="w" />'+U+l+'<label for="rpbchessboard-editFENDialog-turn-b">'+'<span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-b uichess-chessboard-size36"></span>'+v+'<input id="rpbchessboard-editFENDialog-turn-b" type="radio" name="turn" value="b" />'+U+s+r+e[y].ORIENTATION_SECTION_TITLE+s+n+'<input id="rpbchessboard-editFENDialog-flip" type="checkbox" />'+'<label for="rpbchessboard-editFENDialog-flip">'+e[y].FLIP_CHECKBOX_LABEL+v+s+r+e[y].SPECIAL_POSITIONS_SECTION_TITLE+s+n+'<button id="rpbchessboard-editFENDialog-startPosition" class="button rpbchessboard-graphicButton" title="'+e[y].START_POSITION_TOOLTIP+'">'+'<div class="rpbchessboard-startPositionIcon"></div>'+B+'<button id="rpbchessboard-editFENDialog-emptyPosition" class="button rpbchessboard-graphicButton" title="'+e[y].EMPTY_POSITION_TOOLTIP+'">'+'<div class="rpbchessboard-emptyPositionIcon"></div>'+B+s+s+G+e[y].ADVANCED_TAB_LABEL+X+V+r+e[y].CASTLING_SECTION_TITLE+s+n+'<table id="rpbchessboard-editFENDialog-castleRights"><tbody>'+P+"<td></td>"+"<td>O-O-O</td>"+"<td>O-O</td>"+M+P+'<td><span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-b uichess-chessboard-size28"></span></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-bq" type="checkbox" data-color="b" data-side="q" /></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-bk" type="checkbox" data-color="b" data-side="k" /></td>'+M+P+'<td><span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-w uichess-chessboard-size28"></span></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-wq" type="checkbox" data-color="w" data-side="q" /></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-wk" type="checkbox" data-color="w" data-side="k" /></td>'+M+"</tbody></table>"+s+r+e[y].EN_PASSANT_SECTION_TITLE+s+n+'<ul id="rpbchessboard-editFENDialog-enPassantRights">'+"<li>"+'<input id="rpbchessboard-editFENDialog-enPassant-disabled" type="radio" name="enPassant" />'+'<label for="rpbchessboard-editFENDialog-enPassant-disabled">'+e[y].EN_PASSANT_DISABLED_BUTTON_LABEL+v+J+"<li>"+'<input id="rpbchessboard-editFENDialog-enPassant-enabled" type="radio" name="enPassant" />'+'<label for="rpbchessboard-editFENDialog-enPassant-enabled">'+e[y].EN_PASSANT_ENABLED_BUTTON_LABEL.replace("%1$s",'</label><select id="rpbchessboard-editFENDialog-enPassant-column"><option value="a">a</option><option value="b">b</option><option value="c">c</option><option value="d">d</option><option value="e">e</option><option value="f">f</option><option value="g">g</option><option value="h">h</option></select><label for="rpbchessboard-editFENDialog-enPassant-enabled">')+v+J+"</ul>"+s+s+s+s+s+s+s);var g=t(p);g[i]({squareSize:40,allowMoves:"all",sparePieces:w}),t(m+g[i](D))[x](a,w),t(".rpbchessboard-editFENDialog-turnField input").each(function(e,n){t(n)[L](function(){g[i](D,t(n).val())})}),t(f)[L](function(){g[i](b,T,t(this)[x](a))}),t("#rpbchessboard-editFENDialog-startPosition")[L](function(e){e[j](),tt(_)}),t("#rpbchessboard-editFENDialog-emptyPosition")[L](function(e){e[j](),tt("empty")}),t("#rpbchessboard-editFENDialog-castleRights input").each(function(e,n){t(n)[L](function(){g[i](c,t(n)[A]("color"),t(n)[A]("side"),t(n)[x](a))})});var S=t(o);t("#rpbchessboard-editFENDialog-enPassant-disabled")[L](function(){S[x](E,w),g[i](N,W)}),t("#rpbchessboard-editFENDialog-enPassant-enabled")[L](function(){S[x](E,k),S.change()}),S.change(function(){g[i](N,S.val())}),t("#rpbchessboard-editFENDialog-accordion").accordion(),t(u)[I]({autoOpen:k,modal:w,dialogClass:"wp-dialog",title:e[y].EDIT_CHESS_DIAGRAM_DIALOG_TITLE,width:750,buttons:[{text:e[y].CANCEL_BUTTON_LABEL,click:function(){t(this)[I]($)}},{"class":"button-primary",id:"rpbchessboard-editFENDialog-submitButton",text:"",click:function(){t(this)[I]($);var e=t(this)[A](h);if(typeof e===C){var n=g[i](b,F),r=t(this)[A](d);r[T]=t(f)[x](a),e(n,r)}}}]})}function rt(e,t,n){if(t>e[q])return-1;var r=e.substr(t).search(n);return r<0?-1:r+t}function it(e,t,n){e=e.substr(0,t);var r=-1;while(w){var i=rt(e,r+1,n);if(i<0)break;r=i}return r}var n='<div class="rpbchessboard-editFENDialog-sectionContent">',r='<div class="rpbchessboard-editFENDialog-sectionTitle">',i="chessboard",s="</div>",o="#rpbchessboard-editFENDialog-enPassant-column",u="#rpbchessboard-editFENDialog",a="checked",f="#rpbchessboard-editFENDialog-flip",l='<span class="rpbchessboard-editFENDialog-turnField">',c="castleRights",h="callback",p="#rpbchessboard-editFENDialog-chessboard",d="options",v="</label>",m="#rpbchessboard-editFENDialog-turn-",g=null,y="i18n",b="option",w=!0,E="disabled",S="parseWordPressShortcodeAttributes",x="prop",T="flip",N="enPassant",C="function",k=!1,L="click",A="data",O="string",M="</tr>",_="start",D="turn",P="<tr>",H="showCoordinates",B="</button>",j="preventDefault",F="position",I="dialog",q="length",R="boolean",U="</span>",z="object",W="-",X="</h3>",V="<div>",$="close",J="</li>",K="toLowerCase",Q="fen",G="<h3>",Y="FEN_SHORTCODE",Z="squareSize";e[y]={EDITOR_BUTTON_LABEL:i,EDIT_CHESS_DIAGRAM_DIALOG_TITLE:"Insert/edit a chess diagram",CANCEL_BUTTON_LABEL:"Cancel",SUBMIT_BUTTON_ADD_LABEL:"Add a new chess diagram",SUBMIT_BUTTON_EDIT_LABEL:"Update the chess diagram",BASIC_TAB_LABEL:"Basic",TURN_SECTION_TITLE:"Turn",ORIENTATION_SECTION_TITLE:"Orientation",FLIP_CHECKBOX_LABEL:"Flip board",SPECIAL_POSITIONS_SECTION_TITLE:"Special positions",START_POSITION_TOOLTIP:"Set the initial position",EMPTY_POSITION_TOOLTIP:"Clear the chessboard",ADVANCED_TAB_LABEL:"Advanced",CASTLING_SECTION_TITLE:"Castling rights",EN_PASSANT_SECTION_TITLE:"En passant",EN_PASSANT_DISABLED_BUTTON_LABEL:"Not possible",EN_PASSANT_ENABLED_BUTTON_LABEL:"Possible on column %1$s"},e.config={FEN_SHORTCODE:Q},e.showEditFENDialog=function(e){nt();var n=t(u);n[A](h,g),n[A](d,g);if(typeof e===C)n[A](h,e),n[A](d,{}),tt(_,w);else if(typeof e===z&&e!==g){h in e&&typeof e[h]===C&&n[A](h,e[h]);var r=d in e?e[d]:{};n[A](d,r),Q in e&&typeof e[Q]===O?tt(e[Q],k,r):tt(_,w,r)}t(u)[I]("open")},e[S]=function(e){var t={},n=/([a-zA-Z_0-9]+)=([^ \]]+)(?: |\])/g,r=g,i=function(e,t){return t.toUpperCase()};while((r=n.exec(e))!==g){var s=r[1][K]().replace(/_([a-z]?)/g,i);t[s]=r[2]}return t},e.serializeFENShortcodeContent=function(t,n){var r=e.config[Y],i="["+r;return T in n&&n[T]&&(i+=" flip=true"),Z in n&&(i+=" square_size="+n[Z]),H in n&&(i+=" show_coordinates="+n[H]),i+="]"+t+"[/"+r+"]",i},e.identifyFENShortcodeContent=function(t,n,r){var i=e.config[Y],s=3+i[q],o=new RegExp("\\[\\/"+i+"\\]","g"),u=rt(t,Math.max(0,n-s+1),o),a=new RegExp("\\["+i+"[^\\[\\]]*\\]","g"),f=u<0?-1:it(t,u,a);if(f>=0&&u>=0&&f<=n&&r<=u+s){var l=t.substr(f).match(a)[0],c=l[q],h=t.substr(f+c,u-f-c);return{beginShortcode:f,endShortcode:u+s,fen:h,options:e[S](l)}}return g}})(RPBChessboard,jQuery);