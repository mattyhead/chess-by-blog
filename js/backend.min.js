var RPBChessboard={};(function(e,t){"use strict";function et(e){if(typeof e===X)return e;if(typeof e!==M)return w;switch(e.toLowerCase()){case"true":case"yes":case"1":return T;case"false":case"no":case"0":return A;default:return w}}function tt(n,r,i){var a=t(c);if(typeof n===M){a[s](x,R,n),t(y+a[s](q))[S](o,T);var l=a[s](D);t(v)[S](o,l[H]("K")>=0),t(m)[S](o,l[H]("Q")>=0),t(d)[S](o,l[H]("k")>=0),t(p)[S](o,l[H]("q")>=0);var h=a[s](L);t("#rpbchessboard-editFENDialog-enPassant-"+(h===""?N:"enabled"))[S](o,T),t(u)[S](N,h===""),h!==""&&t(u).val(h)}typeof r===X&&t("#rpbchessboard-editFENDialog-submitButton").button(x,"label",r?e[E].SUBMIT_BUTTON_ADD_LABEL:e[E].SUBMIT_BUTTON_EDIT_LABEL);if(typeof i===$&&i!==w){var g=k in i?et(i[k]):w;g===w&&(g=A),a[s](x,k,g),t(f)[S](o,g)}}function nt(){if(t(a)[W]!==0)return;t("body").append('<div id="rpbchessboard-editFENDialog"><div class="rpbchessboard-columns"><div style="width: 450px;"><div id="rpbchessboard-editFENDialog-chessboard"></div>'+i+'<div class="rpbchessboard-stretchable">'+'<div class="rpbchessboard-jQuery-enableSmoothness">'+'<div id="rpbchessboard-editFENDialog-accordion" class="rpbchessboard-accordion">'+"<h3>"+e[E].BASIC_TAB_LABEL+"</h3>"+Q+r+e[E].TURN_SECTION_TITLE+i+n+l+'<label for="rpbchessboard-editFENDialog-turn-w">'+'<span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-w uichess-chessboard-sprite36"></span>'+g+'<input id="rpbchessboard-editFENDialog-turn-w" type="radio" name="turn" value="w" />'+V+l+'<label for="rpbchessboard-editFENDialog-turn-b">'+'<span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-b uichess-chessboard-sprite36"></span>'+g+'<input id="rpbchessboard-editFENDialog-turn-b" type="radio" name="turn" value="b" />'+V+i+r+e[E].ORIENTATION_SECTION_TITLE+i+n+'<input id="rpbchessboard-editFENDialog-flip" type="checkbox" />'+'<label for="rpbchessboard-editFENDialog-flip">'+e[E].FLIP_CHECKBOX_LABEL+g+i+r+e[E].SPECIAL_POSITIONS_SECTION_TITLE+i+n+'<button id="rpbchessboard-editFENDialog-startPosition" class="button rpbchessboard-graphicButton" title="'+e[E].START_POSITION_TOOLTIP+'">'+'<div class="rpbchessboard-startPositionIcon"></div>'+I+'<button id="rpbchessboard-editFENDialog-emptyPosition" class="button rpbchessboard-graphicButton" title="'+e[E].EMPTY_POSITION_TOOLTIP+'">'+'<div class="rpbchessboard-emptyPositionIcon"></div>'+I+i+i+"<h3>"+e[E].ADVANCED_TAB_LABEL+"</h3>"+Q+r+e[E].CASTLING_SECTION_TITLE+i+n+'<table id="rpbchessboard-editFENDialog-castleRights"><tbody>'+F+"<td></td>"+"<td>O-O-O</td>"+"<td>O-O</td>"+P+F+'<td><span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-b uichess-chessboard-sprite28"></span></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-bq" type="checkbox" /></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-bk" type="checkbox" /></td>'+P+F+'<td><span class="rpbchessboard-editFENDialog-turnFlag uichess-chessboard-turnFlag uichess-chessboard-color-w uichess-chessboard-sprite28"></span></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-wq" type="checkbox" /></td>'+'<td><input id="rpbchessboard-editFENDialog-castle-wk" type="checkbox" /></td>'+P+"</tbody></table>"+i+r+e[E].EN_PASSANT_SECTION_TITLE+i+n+'<ul id="rpbchessboard-editFENDialog-enPassantRights">'+"<li>"+'<input id="rpbchessboard-editFENDialog-enPassant-disabled" type="radio" name="enPassant" />'+'<label for="rpbchessboard-editFENDialog-enPassant-disabled">'+e[E].EN_PASSANT_DISABLED_BUTTON_LABEL+g+G+"<li>"+'<input id="rpbchessboard-editFENDialog-enPassant-enabled" type="radio" name="enPassant" />'+'<label for="rpbchessboard-editFENDialog-enPassant-enabled">'+e[E].EN_PASSANT_ENABLED_BUTTON_LABEL.replace("%1$s",'</label><select id="rpbchessboard-editFENDialog-enPassant-column"><option value="a">a</option><option value="b">b</option><option value="c">c</option><option value="d">d</option><option value="e">e</option><option value="f">f</option><option value="g">g</option><option value="h">h</option></select><label for="rpbchessboard-editFENDialog-enPassant-enabled">')+g+G+"</ul>"+i+i+i+i+i+i+i);var w=t(c);w[s]({squareSize:40,allowMoves:"all",sparePieces:T}),t(y+w[s](q))[S](o,T),t(".rpbchessboard-editFENDialog-turnField input").each(function(e,n){t(n)[O](function(){w[s](q,t(n).val())})}),t(f)[O](function(){w[s](x,k,t(this)[S](o))}),t("#rpbchessboard-editFENDialog-startPosition")[O](function(e){e[U](),tt(B)}),t("#rpbchessboard-editFENDialog-emptyPosition")[O](function(e){e[U](),tt("empty")}),t("#rpbchessboard-editFENDialog-castleRights input").each(function(e,n){t(n)[O](function(){var e="";t(v)[S](o)&&(e+="K"),t(m)[S](o)&&(e+="Q"),t(d)[S](o)&&(e+="k"),t(p)[S](o)&&(e+="q"),w[s](D,e)})});var C=t(u);t("#rpbchessboard-editFENDialog-enPassant-disabled")[O](function(){C[S](N,T),w[s](L,"")}),t("#rpbchessboard-editFENDialog-enPassant-enabled")[O](function(){C[S](N,A),C.change()}),C.change(function(){w[s](L,C.val())}),t("#rpbchessboard-editFENDialog-accordion").accordion(),t(a)[z]({autoOpen:A,modal:T,dialogClass:"wp-dialog",title:e[E].EDIT_CHESS_DIAGRAM_DIALOG_TITLE,width:750,buttons:[{text:e[E].CANCEL_BUTTON_LABEL,click:function(){t(this)[z](J)}},{"class":"button-primary",id:"rpbchessboard-editFENDialog-submitButton",text:"",click:function(){t(this)[z](J);var e=t(this).data(h);if(typeof e===_){var n=w[s](x,R),r=t(this).data(b);r[k]=t(f)[S](o),e(n,r)}}}]})}function rt(e,t,n){if(t>e[W])return-1;var r=e.substr(t).search(n);return r<0?-1:r+t}function it(e,t,n){e=e.substr(0,t);var r=-1;while(T){var i=rt(e,r+1,n);if(i<0)break;r=i}return r}var n='<div class="rpbchessboard-editFENDialog-sectionContent">',r='<div class="rpbchessboard-editFENDialog-sectionTitle">',i="</div>",s="chessboard",o="checked",u="#rpbchessboard-editFENDialog-enPassant-column",a="#rpbchessboard-editFENDialog",f="#rpbchessboard-editFENDialog-flip",l='<span class="rpbchessboard-editFENDialog-turnField">',c="#rpbchessboard-editFENDialog-chessboard",h="callback",p="#rpbchessboard-editFENDialog-castle-bq",d="#rpbchessboard-editFENDialog-castle-bk",v="#rpbchessboard-editFENDialog-castle-wk",m="#rpbchessboard-editFENDialog-castle-wq",g="</label>",y="#rpbchessboard-editFENDialog-turn-",b="options",w=null,E="i18n",S="prop",x="option",T=!0,N="disabled",C="parseWordPressShortcodeAttributes",k="flip",L="enPassant",A=!1,O="click",M="string",_="function",D="castleRights",P="</tr>",H="indexOf",B="start",j="showCoordinates",F="<tr>",I="</button>",q="turn",R="position",U="preventDefault",z="dialog",W="length",X="boolean",V="</span>",$="object",J="close",K="fen",Q="<div>",G="</li>",Y="FEN_SHORTCODE",Z="squareSize";e[E]={EDITOR_BUTTON_LABEL:s,EDIT_CHESS_DIAGRAM_DIALOG_TITLE:"Insert/edit a chess diagram",CANCEL_BUTTON_LABEL:"Cancel",SUBMIT_BUTTON_ADD_LABEL:"Add a new chess diagram",SUBMIT_BUTTON_EDIT_LABEL:"Update the chess diagram",BASIC_TAB_LABEL:"Basic",TURN_SECTION_TITLE:"Turn",ORIENTATION_SECTION_TITLE:"Orientation",FLIP_CHECKBOX_LABEL:"Flip board",SPECIAL_POSITIONS_SECTION_TITLE:"Special positions",START_POSITION_TOOLTIP:"Set the initial position",EMPTY_POSITION_TOOLTIP:"Clear the chessboard",ADVANCED_TAB_LABEL:"Advanced",CASTLING_SECTION_TITLE:"Castling rights",EN_PASSANT_SECTION_TITLE:"En passant",EN_PASSANT_DISABLED_BUTTON_LABEL:"Not possible",EN_PASSANT_ENABLED_BUTTON_LABEL:"Possible on column %1$s"},e.config={FEN_SHORTCODE:K},e.showEditFENDialog=function(e){nt();var n=t(a);n.data(h,w),n.data(b,w);if(typeof e===_)n.data(h,e),n.data(b,{}),tt(B,T);else if(typeof e===$&&e!==w){h in e&&typeof e[h]===_&&n.data(h,e[h]);var r=b in e?e[b]:{};n.data(b,r),K in e&&typeof e[K]===M?tt(e[K],A,r):tt(B,T,r)}t(a)[z]("open")},e[C]=function(e){var t={},n=/([a-zA-Z_0-9]+)=([^ \]]+)(?: |\])/g,r=w,i=function(e,t){return t.toUpperCase()};while((r=n.exec(e))!==w){var s=r[1].toLowerCase().replace(/_([a-z]?)/g,i);t[s]=r[2]}return t},e.serializeFENShortcodeContent=function(t,n){var r=e.config[Y],i="["+r;return k in n&&n[k]&&(i+=" flip=true"),Z in n&&(i+=" square_size="+n[Z]),j in n&&(i+=" show_coordinates="+n[j]),i+="]"+t+"[/"+r+"]",i},e.identifyFENShortcodeContent=function(t,n,r){var i=e.config[Y],s=3+i[W],o=new RegExp("\\[\\/"+i+"\\]","g"),u=rt(t,Math.max(0,n-s+1),o),a=new RegExp("\\["+i+"[^\\[\\]]*\\]","g"),f=u<0?-1:it(t,u,a);if(f>=0&&u>=0&&f<=n&&r<=u+s){var l=t.substr(f).match(a)[0],c=l[W],h=t.substr(f+c,u-f-c);return{beginShortcode:f,endShortcode:u+s,fen:h,options:e[C](l)}}return w}})(RPBChessboard,jQuery);